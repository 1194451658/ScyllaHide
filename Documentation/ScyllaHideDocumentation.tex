\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[english]{isodate}
\usepackage[parfill]{parskip}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{hyperref}

\lstdefinestyle{customc}{
  belowcaptionskip=1\baselineskip,
  breaklines=true,
  frame=L,
  xleftmargin=\parindent,
  language=C,
  showstringspaces=false,
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\bfseries\color{green!40!black},
  commentstyle=\itshape\color{purple!40!black},
  identifierstyle=\color{blue},
  stringstyle=\color{orange},
}

\lstdefinestyle{customasm}{
  belowcaptionskip=1\baselineskip,
  frame=L,
  xleftmargin=\parindent,
  language=[x86masm]Assembler,
  basicstyle=\footnotesize\ttfamily,
  commentstyle=\itshape\color{purple!40!black},
}

\lstset{escapechar=@,style=customc}
\hypersetup{
  colorlinks   = true,    % Colours links instead of ugly boxes
  urlcolor     = black,    % Colour for external hyperlinks
  linkcolor    = black,    % Colour of internal links
  citecolor    = red      % Colour of citations
}

\title{ScyllaHide v1.1 - Documentation}
\author{Developed by NtQuery and cypher}
\date{2014-08-15}

\begin{document}


\maketitle
 
\pagenumbering{Roman}
\tableofcontents

\newpage
\pagenumbering{arabic}

\section{Features}

\subsection{Anti-Anti-Debug}
\subsubsection{Process Environment Block (PEB)}
\subsection{Special}
\subsubsection{DLL Injection}
\subsubsection{Prevent Thread Creation}
\subsubsection{RunPE Unpacker}



\subsection{OllyDbg v1 Specific}
\subsubsection{Remove entry point breakpoint}
Some protectors use Thread-Local-Storage (TLS) as entrypoint and check for breakpoints at the normal PE entrypoint address. You must remove the PE entrypoint to hide your debugger. This option is necessary for VMProtect.
\subsubsection{Fix Olly Bugs}
This option fixes various OllyDbg bugs: ForegroundWindow, PE fix for NumOfRvaAndSizes, FPU bug, sprintf bug
\subsubsection{x64 single-step fix}
OllyDbg doesn't work very well on x64 operating systems. This option fixes the most annoying bug.
\subsubsection{Skip Entrypoint outside code}
Annoying warning can be skipped.
\subsubsection{Ignore bad PE image}
Annoying warning can be skipped.
\subsubsection{Skip compressed code warning}
Annoying warning can be skipped with a default behaviour.
\subsubsection{Skip "load dll" warning}
Annoying warning can be skipped with a default behaviour.
\subsubsection{Break on TLS}
This options sets a breakpoint to any available Thread-Local-Storage (TLS) address. This is necessary for various protectors e.g. VMProtect.
\subsubsection{Advanced CTRL+G}
Replaces the default OllyDbg "Go to Address" dialog. Now you can enter RVA and offset values. Be sure to select the correct module.
\subsubsection{Change window caption}
Change the OllyDbg window caption. This can be useful against e.g. FindWindow anti-debug tricks. You don't need to enable this, if you have the NtUser* hooks enabled! Hint: You can use it to make the currently used profile visible.


\subsection{OllyDbg v2 Specific}
\subsubsection{Change window caption}
Change the OllyDbg window caption. This can be useful against e.g. FindWindow anti-debug tricks. You don't need to enable this, if you have the NtUser* hooks enabled! Hint: You can use it to make the currently used profile visible.
\subsection{IDA Specific}
\subsection{x64dbg Specific}
\subsection{TitanEngine Specific}
\section{Advanced Information}
\subsection{Special PEB Fix Information}

There is a special piece of code inside the debug loop of the plugins and it seems like there is a bug:
\begin{lstlisting}
    if (pHideOptions.PEBHeapFlags)
    {
        if (specialPebFix)
        {
            StartFixBeingDebugged(ProcessId, false);
            specialPebFix = false;
        }

        if (debugevent->u.LoadDll.lpBaseOfDll == hNtdllModule)
        {
            StartFixBeingDebugged(ProcessId, true);
            specialPebFix = true;
        }
    }
\end{lstlisting}
But this code is correct and very important. This nice trick removes heap artifacts (You can read more about it here: http://pferrie.tripod.com/papers/unpackers.pdf "The heap"). Themida and other protectors are checking for heap artifacts. Instead of manually wiping the artifacts, the code prevents the heap artifact creation.

\end{document}